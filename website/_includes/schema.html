{% comment %}
JSON-LD Structured Data for SEO
Includes: Organization, WebSite, SoftwareApplication, BreadcrumbList, Article/TechArticle
{% endcomment %}

{% assign page_url = page.url | absolute_url %}
{% assign page_title = page.title | default: site.title %}
{% assign page_description = page.description | default: site.description | strip_html | truncate: 160 %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
      "@id": "{{ site.url }}/#organization",
      "name": "{{ site.title }}",
      "url": "{{ site.url }}",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ site.url }}/assets/images/logo.png"
      },
      "sameAs": [
        "https://github.com/{{ site.repository }}",
        "https://twitter.com/{{ site.twitter.username }}"
      ]
    },
    {
      "@type": "WebSite",
      "@id": "{{ site.url }}/#website",
      "url": "{{ site.url }}",
      "name": "{{ site.title }}",
      "description": "{{ site.description | strip_html }}",
      "publisher": {
        "@id": "{{ site.url }}/#organization"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "{{ site.url }}/docs/CLI/?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      }
    },
    {
      "@type": "SoftwareApplication",
      "@id": "{{ site.url }}/#software",
      "name": "{{ site.title }}",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "macOS, Linux, Windows",
      "description": "{{ site.description | strip_html }}",
      "url": "{{ site.url }}",
      "downloadUrl": "https://github.com/{{ site.repository }}",
      "softwareVersion": "{{ site.version | default: '0.3.5' }}",
      "author": {
        "@type": "Person",
        "name": "{{ site.author.name }}",
        "url": "{{ site.author.url }}"
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Hybrid BM25 + Vector Search",
        "Local LLM Integration",
        "PDF, DOCX, XLSX Support",
        "MCP Server for AI Agents",
        "Privacy-First Design"
      ]
    }
    {% if page.layout == 'page' and page.url contains '/docs/' %}
    ,{
      "@type": "TechArticle",
      "@id": "{{ page_url }}",
      "headline": "{{ page_title | escape }}",
      "description": "{{ page_description | escape }}",
      "url": "{{ page_url }}",
      "datePublished": "{{ page.date | default: site.time | date_to_xmlschema }}",
      "dateModified": "{{ page.last_modified_at | default: site.time | date_to_xmlschema }}",
      "author": {
        "@type": "Person",
        "name": "{{ site.author.name }}"
      },
      "publisher": {
        "@id": "{{ site.url }}/#organization"
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ page_url }}"
      },
      "isPartOf": {
        "@id": "{{ site.url }}/#website"
      },
      "about": {
        "@id": "{{ site.url }}/#software"
      }
    }
    {% endif %}
    {% if page.url contains '/docs/' %}
    ,{
      "@type": "BreadcrumbList",
      "@id": "{{ page_url }}#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "{{ site.url }}"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Documentation",
          "item": "{{ site.url }}/docs/QUICKSTART/"
        }
        {% if page.title %}
        ,{
          "@type": "ListItem",
          "position": 3,
          "name": "{{ page_title | escape }}",
          "item": "{{ page_url }}"
        }
        {% endif %}
      ]
    }
    {% endif %}
    {% if page.url contains '/features/' and page.url != '/features/' %}
    ,{
      "@type": "BreadcrumbList",
      "@id": "{{ page_url }}#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "{{ site.url }}"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Features",
          "item": "{{ site.url }}/features/"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "{{ page_title | escape }}",
          "item": "{{ page_url }}"
        }
      ]
    }
    {% endif %}
  ]
}
</script>
